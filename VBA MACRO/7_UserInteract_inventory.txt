' Search String for adding User Interaction 
' --USERINTERACTIONADDED
Sub InventoryUpdateNested()

Dim ItemId As Long
Dim ProductName As String
Dim Delivery As Integer
Dim KeepSearching As Boolean
Dim RowNum As Long
Dim updatestock As Integer
Dim index As Integer
dim addnew as byte  ' --USERINTERACTIONADDED

'Initialization
index = 2
addnew = vbNo ' --USERINTERACTIONADDED

Worksheets("update").Activate
updatestock = Application.CountA(Range("A:A"))

Do While index <= updatestock
Worksheets("update").Activate
ItemId = Cells(index, 1).Value
ProductName = Cells(index, 2).Value
Delivery = Cells(index, 3).Value
KeepSearching = True
RowNum = 3

    Do While KeepSearching
        Worksheets("inventory").Activate
        If Cells(RowNum, 1).Value = ItemId Then
            Cells(RowNum, 3).Value = Cells(RowNum, 3).Value + Delivery
            Cells(RowNum, 4).Value = Date
            
            KeepSearching = False
            
        ElseIf Cells(RowNum, 1).Value = "" Then
        	addnew = MsgBox ("could not find id "& ItemId & "." & vbcrif & " do u want to add ? " _
			,vbyesno, "Add new stock item ?")  ' --USERINTERACTIONADDED
			
			if addnew = "yes" Then ' --USERINTERACTIONADDED
				Cells(RowNum, 1).Value = ItemId
				Cells(RowNum, 2).Value = ProductName
				Cells(RowNum, 3).Value = Delivery
				Cells(RowNum, 4).Value = Date
            End if ' --USERINTERACTIONADDED
            KeepSearching = False
            
        Else
            RowNum = RowNum + 1
        End If
    
    Loop
    index = index + 1
Loop

Worksheets("Update").Activate
Range("A2:C" & updatestock).ClearContents
MsgBox "The inventory sheet has been updated"

End Sub
